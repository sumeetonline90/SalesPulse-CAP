<mvc:View controllerName="com.sap.salespulse.salespulseui.controller.Main"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:unified="sap.ui.unified"
    xmlns:core="sap.ui.core"
    xmlns:layout="sap.ui.layout">
    
    <Page id="page">
        <customHeader>
            <Bar>
                <contentLeft>
                    <HBox alignItems="Center" class="sapUiSmallMarginEnd">
                        <core:HTML content="&lt;div style='display: flex; align-items: center; margin-right: 10px;'&gt;&lt;div style='display: flex; flex-direction: column; margin-right: 8px;'&gt;&lt;div style='width: 20px; height: 5px; background: #4FC3F7; border-radius: 3px; margin-bottom: 2px; transform: rotate(-5deg);'&gt;&lt;/div&gt;&lt;div style='width: 22px; height: 5px; background: #81C784; border-radius: 3px; margin-bottom: 2px; transform: rotate(2deg);'&gt;&lt;/div&gt;&lt;div style='width: 24px; height: 5px; background: #FF7043; border-radius: 3px; transform: rotate(-2deg);'&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style='font-family: Arial, sans-serif; font-weight: bold; color: #1976D2; font-size: 16px;'&gt;&lt;span style='color: #0D47A1;'&gt;I&lt;/span&gt;&lt;span style='color: #42A5F5;'&gt;NN&lt;/span&gt;&lt;span style='color: #42A5F5; position: relative;'&gt;O&lt;span style='position: absolute; top: -1px; left: 50%; transform: translateX(-50%); font-size: 6px; color: #666;'&gt;◐&lt;/span&gt;&lt;/span&gt;&lt;span style='color: #0D47A1; transform: scaleY(1.2);'&gt;✓&lt;/span&gt;&lt;span style='color: #42A5F5;'&gt;AL&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;"/>
                        <core:Icon src="sap-icon://line-charts" size="1.5rem" color="#1976D2"/>
                    </HBox>
                </contentLeft>
                <contentMiddle>
                    <Title text="SalesPulse Analytics Dashboard" level="H1"/>
                </contentMiddle>
            </Bar>
        </customHeader>
        
        <content>
            <VBox class="sapUiMediumMargin">
                <!-- Two-Column Header Grid -->
                <layout:Grid defaultSpan="XL6 L6 M12 S12" class="sapUiMediumMarginBottom">
                    <layout:content>
                        <!-- Left Column: INNOVAL Logo and Analytics -->
                        <Panel class="sapUiResponsiveMargin">
                            <content>
                                <VBox alignItems="Center" justifyContent="Center" class="sapUiLargeMargin">
                                    <!-- INNOVAL Logo -->
                                    <VBox alignItems="Center" class="sapUiMediumMarginBottom">
                                        <core:HTML content="&lt;div style='display: flex; align-items: center; margin-bottom: 20px;'&gt;&lt;div style='display: flex; flex-direction: column; margin-right: 15px;'&gt;&lt;div style='width: 30px; height: 8px; background: #4FC3F7; border-radius: 4px; margin-bottom: 4px; transform: rotate(-5deg);'&gt;&lt;/div&gt;&lt;div style='width: 35px; height: 8px; background: #81C784; border-radius: 4px; margin-bottom: 4px; transform: rotate(2deg);'&gt;&lt;/div&gt;&lt;div style='width: 40px; height: 8px; background: #FF7043; border-radius: 4px; transform: rotate(-2deg);'&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style='font-family: Arial, sans-serif; font-weight: bold; color: #1976D2;'&gt;&lt;span style='color: #0D47A1; font-size: 24px;'&gt;I&lt;/span&gt;&lt;span style='color: #42A5F5; font-size: 20px;'&gt;NN&lt;/span&gt;&lt;span style='color: #42A5F5; font-size: 20px; position: relative;'&gt;O&lt;span style='position: absolute; top: -2px; left: 50%; transform: translateX(-50%); font-size: 8px; color: #666;'&gt;◐&lt;/span&gt;&lt;/span&gt;&lt;span style='color: #0D47A1; font-size: 24px; transform: scaleY(1.2);'&gt;✓&lt;/span&gt;&lt;span style='color: #42A5F5; font-size: 20px;'&gt;AL&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;"/>
                                        <Text text="INNOVATION &amp; VALUE" 
                                              textAlign="Center" 
                                              class="sapUiTinyMarginTop"
                                              style="font-size: 10px; color: #666;"/>
                                    </VBox>
                                    
                                    <!-- Analytics Icon -->
                                    <core:HTML content="&lt;svg width='120' height='120' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'&gt;&lt;path fill='#1976D2' d='M5 19h14a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2zm1-8h2v6H6v-6zm3 2h2v4H9v-4zm3-4h2v8h-2V9zm3 2h2v6h-2v-6z'/&gt;&lt;/svg&gt;"/>
                                    <Title text="SalesPulse Analytics" level="H2" class="sapUiSmallMarginTop"/>
                                    <Text text="Powered by INNOVAL - Upload your sales data to get instant insights and analytics" 
                                          textAlign="Center" 
                                          class="sapUiMediumMarginTop"/>
                                </VBox>
                            </content>
                        </Panel>
                        
                        <!-- Right Column: Upload Functionality -->
                        <Panel class="sapUiResponsiveMargin">
                            <headerToolbar>
                                <Toolbar>
                                    <core:Icon src="sap-icon://upload" size="1.5rem" color="#007bff"/>
                                    <Title text="Upload Sales Data" level="H3" class="sapUiSmallMarginBegin"/>
                                </Toolbar>
                            </headerToolbar>
                            <content>
                                <VBox class="sapUiMediumMargin">
                                    <Label text="Select Excel File (.xlsx)" 
                                           class="sapUiSmallMarginBottom"
                                           design="Bold"/>
                                    <unified:FileUploader 
                                        id="fileUploader"
                                        name="excelFile"
                                        tooltip="Upload your Excel file here"
                                        change="onFileChange"
                                        typeMissmatch="onTypeMissmatch"
                                        style="Emphasized"
                                        fileType="xlsx"
                                        placeholder="Choose Excel file..."
                                        class="sapUiMediumMarginBottom"/>
                                    <Button 
                                        id="uploadButton"
                                        text="Upload Data"
                                        type="Emphasized"
                                        icon="sap-icon://upload-to-cloud"
                                        press="onUpload"
                                        enabled="false"
                                        class="sapUiSmallMarginTop"
                                        width="100%"/>
                                </VBox>
                            </content>
                        </Panel>
                    </layout:content>
                </layout:Grid>

                <!-- Two-Column Layout for Table and Chart -->
                <layout:Grid defaultSpan="XL6 L6 M12 S12" class="sapUiMediumMarginBottom">
                    <layout:content>
                        <!-- Left Column: Sales Data Table -->
                        <Panel class="sapUiResponsiveMargin">
                            <headerToolbar>
                                <Toolbar>
                                    <core:Icon src="sap-icon://table-view" size="1.5rem" color="#007bff"/>
                                    <Title text="Sales Orders Data" level="H3" class="sapUiSmallMarginBegin"/>
                                    <ToolbarSpacer/>
                                    <Button 
                                        icon="sap-icon://add"
                                        press="onCreateOrder"
                                        tooltip="Add New Order"
                                        type="Emphasized"
                                        class="sapUiTinyMarginEnd"/>
                                    <Button 
                                        icon="sap-icon://refresh"
                                        press="onRefresh"
                                        tooltip="Refresh Data"
                                        type="Transparent"/>
                                </Toolbar>
                            </headerToolbar>
                    <content>
                        <Table 
                            id="salesTable"
                            items="{/SalesOrders}"
                            growing="true"
                            growingThreshold="20"
                            class="sapUiResponsiveMargin">
                            <columns>
                                <Column>
                                    <Text text="Order ID" design="Bold"/>
                                </Column>
                                <Column>
                                    <Text text="Region" design="Bold"/>
                                </Column>
                                <Column>
                                    <Text text="Country" design="Bold"/>
                                </Column>
                                <Column>
                                    <Text text="Product" design="Bold"/>
                                </Column>
                                <Column>
                                    <Text text="Revenue" design="Bold"/>
                                </Column>
                                <Column>
                                    <Text text="Order Date" design="Bold"/>
                                </Column>
                                <Column>
                                    <Text text="Actions" design="Bold"/>
                                </Column>
                            </columns>
                            <items>
                                <ColumnListItem>
                                    <Text text="{OrderID}"/>
                                    <Text text="{Region}"/>
                                    <Text text="{Country}"/>
                                    <Text text="{Product}"/>
                                    <ObjectNumber 
                                        number="{Revenue}" 
                                        unit="USD"
                                        state="Success"
                                        emphasized="true"/>
                                    <Text text="{path: 'OrderDate', type: 'sap.ui.model.type.Date', formatOptions: { style: 'medium' }}"/>
                                    <HBox justifyContent="End">
                                        <Button 
                                            icon="sap-icon://edit"
                                            press="onEditOrder"
                                            tooltip="Edit Order"
                                            type="Transparent"
                                            class="sapUiTinyMarginEnd"/>
                                        <Button 
                                            icon="sap-icon://delete"
                                            press="onDeleteOrder"
                                            tooltip="Delete Order"
                                            type="Transparent"/>
                                    </HBox>
                                </ColumnListItem>
                            </items>
                        </Table>
                    </content>
                        </Panel>
                        
                        <!-- Right Column: Geography Chart -->
                        <Panel class="sapUiResponsiveMargin">
                            <headerToolbar>
                                <Toolbar>
                                    <core:Icon src="sap-icon://pie-chart" size="1.5rem" color="#007bff"/>
                                    <Title text="Geography Distribution" level="H3" class="sapUiSmallMarginBegin"/>
                                    <ToolbarSpacer/>
                                    <Button 
                                        icon="sap-icon://refresh"
                                        press="onRefreshChart"
                                        tooltip="Refresh Chart"
                                        type="Transparent"/>
                                </Toolbar>
                            </headerToolbar>
                            <content>
                                <VBox alignItems="Center" justifyContent="Center" class="sapUiLargeMargin">
                                    <core:HTML id="pieChartContainer" 
                                               content="&lt;div id='chartContainer' style='width: 100%; height: 300px;'&gt;&lt;/div&gt;"/>
                                </VBox>
                            </content>
                        </Panel>
                    </layout:content>
                </layout:Grid>
            </VBox>
        </content>
    </Page>
</mvc:View>